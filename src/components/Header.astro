---
import { t } from '../utils/i18n';

const { locale } = Astro.props;
const basePath = locale === 'es' ? '' : `/${locale}`;
---

<header class="bg-white/95 backdrop-blur-md shadow-md sticky top-0 z-50 border-b-4 border-orange-400 pt-[env(safe-area-inset-top)]">
  <nav class="container mx-auto px-3 max-w-7xl h-14 flex items-center justify-between">

    <!-- LOGO -->
    <a href={basePath || '/'} class="font-bold text-xl">
      DIVERPARK
    </a>

    <!-- BOTÓN HAMBURGUESA -->
    <details id="mobile-menu-details" class="md:hidden">
      <summary
        class="list-none flex items-center justify-center w-11 h-11 min-w-[44px] min-h-[44px] rounded-xl bg-orange-500 text-white cursor-pointer [&::-webkit-details-marker]:hidden"
        aria-label="Abrir menú"
      >
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M4 6h16M4 12h16M4 18h16" />
        </svg>
      </summary>
    </details>
  </nav>
</header>

<!-- OVERLAY -->
<div
  id="mobile-menu-overlay"
  class="fixed left-0 right-0 bottom-0 bg-black/40 z-[100] hidden md:hidden"
  style="top: calc(3.5rem + env(safe-area-inset-top, 0px));"
></div>

<!-- PANEL MENÚ -->
<ul
  id="mobile-menu-panel"
  class="fixed left-0 right-0 bottom-0 z-[110] hidden md:hidden flex flex-col gap-0 px-3 py-4 bg-white shadow-2xl border-t-2 border-orange-200 overflow-y-auto"
  style="
    top: calc(3.5rem + env(safe-area-inset-top, 0px));
    padding-bottom: calc(1rem + env(safe-area-inset-bottom, 0px));
  "
>
  <li>
    <a
      href={basePath || '/'}
      class="flex items-center min-h-[48px] px-4 py-3 text-base font-bold text-gray-800 rounded-xl hover:bg-orange-50"
    >
      {t(locale, 'nav.home')}
    </a>
  </li>

  <li class="border-t border-gray-100 mt-2 pt-2">
    <p class="px-4 py-2 text-xs font-bold text-orange-600 uppercase">
      {t(locale, 'nav.castles')}
    </p>

    <a href={`${basePath}/castillos-pequenos`}
       class="flex items-center min-h-[48px] px-4 py-3 text-base font-semibold text-gray-700 rounded-xl hover:bg-orange-50">
      {t(locale, 'nav.smallCastles')}
    </a>

    <a href={`${basePath}/castillos-grandes`}
       class="flex items-center min-h-[48px] px-4 py-3 text-base font-semibold text-gray-700 rounded-xl hover:bg-orange-50">
      {t(locale, 'nav.largeCastles')}
    </a>

    <a href={`${basePath}/castillos-tobogan`}
       class="flex items-center min-h-[48px] px-4 py-3 text-base font-semibold text-gray-700 rounded-xl hover:bg-orange-50">
      {t(locale, 'nav.slideCastles')}
    </a>

    <a href={`${basePath}/castillos-acuaticos`}
       class="flex items-center min-h-[48px] px-4 py-3 text-base font-semibold text-gray-700 rounded-xl hover:bg-orange-50">
      {t(locale, 'nav.waterCastles')}
    </a>
  </li>

  <li class="border-t border-gray-100 mt-2">
    <a href={`${basePath}/toro-mecanico`}
       class="flex items-center min-h-[48px] px-4 py-3 text-base font-bold text-gray-800 rounded-xl hover:bg-orange-50">
      {t(locale, 'nav.mechanicalBull')}
    </a>
  </li>

  <li class="border-t border-gray-100 mt-4">
    <a
      href={`${basePath}/contacto`}
      class="flex items-center justify-center min-h-[48px] rounded-xl bg-orange-500 text-white font-bold hover:bg-orange-600"
    >
      {t(locale, 'nav.contact')}
    </a>
  </li>
</ul>

<script>
  const details = document.getElementById('mobile-menu-details');
  const overlay = document.getElementById('mobile-menu-overlay');
  const panel = document.getElementById('mobile-menu-panel');

  details?.addEventListener('toggle', () => {
    const open = details.hasAttribute('open');
    overlay.classList.toggle('hidden', !open);
    panel.classList.toggle('hidden', !open);
    document.body.style.overflow = open ? 'hidden' : '';
  });

  overlay?.addEventListener('click', () => {
    details?.removeAttribute('open');
  });
</script>
